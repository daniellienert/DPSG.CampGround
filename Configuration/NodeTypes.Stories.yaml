##
# Document NodeType "StoryList"
#
'DPSG.CampGround:StoryList':
  superTypes: ['TYPO3.Neos:Document']

  constraints:
    nodeTypes:
      'DPSG.CampGround:Story': TRUE
      '*': FALSE

  ui:
    label: 'Story List'
    icon: 'icon-list-alt'
  properties:
    sourceNode:
      type: reference
      ui:
        label: 'Liste an Eintr√§gen'
        reloadIfChanged: TRUE
        inspector:
          group: 'document'


##
# Document NodeType "Story"
#

'DPSG.CampGround:Story':
  superTypes: ['TYPO3.Neos:Document']

  childNodes:
    'main':
      type: 'TYPO3.Neos:ContentCollection'

  ui:
    label: 'Story'
    icon: 'icon-calendar'
    inspector:
      groups:
        storyProperties:
          label: 'Eigenschaften'
          position: 1

  properties:
    title:
      type: string
      ui:
        inlineEditable: TRUE
        inspector:
          group: ~

    storyStartDate:
      type: date
      ui:
        reloadIfChanged: FALSE
        label: 'Startdatum'
        inspector:
          group: 'storyProperties'

    storyEndDate:
      type: date
      ui:
        reloadIfChanged: FALSE
        label: 'Enddatum'
        inspector:
          group: 'storyProperties'

    group:
      type: references
      ui:
        reloadIfChanged: TRUE
        label: 'Stufe'
        inspector:
          group: 'storyProperties'
          editorOptions:
            nodeTypes: ['DPSG.CampGround::Stufe']


    author:
      type: string
      ui:
        reloadIfChanged: FALSE
        label: 'Autor'
        inspector:
          group: 'storyProperties'

    'storyHeaderImage':
      type: 'TYPO3\Media\Domain\Model\ImageVariant'
      ui:
        label: 'Artikelbild'
        reloadIfChanged: true
        inspector:
          group: 'storyProperties'
      search:
        elasticSearchMapping:
          type: string
          include_in_all: false
        indexing: '${(node.properties.storyHeaderImage ? "set" : "missing")}'


##
# Story Teaser
#
'DPSG.CampGround:StorySlider':
  superTypes: ['TYPO3.Neos:Content']
  ui:
    label: 'Artikel Slider'
    inspector:
      groups:
        'stories':
          label: 'Artikel'
          position: 10

  properties:
    numberOfArticles:
      type: integer
      validation:
        'TYPO3.Neos/Validation/NotEmptyValidator': []
        'TYPO3.Neos/Validation/IntegerValidator': []
      ui:
        label: 'Anzahl Artikel'
        reloadIfChanged: TRUE
        inspector:
          group: 'stories'

##
# Latest Articles
#
'DPSG.CampGround:LatestStories':
  superTypes: ['TYPO3.Neos:Content']
  ui:
    label: 'Aktuelle Berichte'
    inspector:
      groups:
        'latestStories':
          label: 'Aktuelle Berichte'
          position: 1

  properties:
    numberOfArticles:
      type: integer
      validation:
        'TYPO3.Neos/Validation/NotEmptyValidator': []
        'TYPO3.Neos/Validation/IntegerValidator': []
      ui:
        label: 'Anzahl Berichte'
        reloadIfChanged: TRUE
        inspector:
          group: 'latestStories'
